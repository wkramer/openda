
<!DOCTYPE html>
<html>
 <head>
   <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <title>SANGOMA data assimilation tools</title>
   <style media="screen" type="text/css">
body {
  background: #fff;
  color: #000;
  margin: 10px; 
  padding: 10px;
}

body, h1, h2, h3 {
  font-family: verdana,sans;
}

h1 {
  padding: 4px;
  text-align: center;
  color:  #363;
}

h2 { 
  padding: 4px;
  color:  #363;
  border-bottom: thin solid #363;
}

h3 { 
  padding: 4px;
  font-weight: bold;
  color:  #363;
}

p {
  margin: 0.5em 0;
}

pre.code {
  margin-left: 30pt;
  border: 1pt dashed #363;
  white-space: pre;
  overflow: auto;
  padding: 7pt;
}

a {
 color: #363;
}
	

.code {
  font-family: monospace,"New Courier";
}

div.toc {
  border: 1pt solid #363;
  background-color: #F9FCF9;
  color:  #363;
}

/* limit with of toc on desktops */
@media (min-width: 21em) { 
    .toc  {
       width: 20em;
    }
}

h2 a {
  text-decoration: none;
}

#toctitle {
  margin-top: 5px;
  text-align: center;
  color:  #363;
  border-bottom: none;
  font-size: 100%;
  font-weight: bold;
}

.toc ul {
  list-style-type: none;
  list-style-image: none;
  text-align: left;
  padding-left: 20px;
}

.toc a {
  text-decoration: none;
}


/* counters */

body {
  counter-reset: section
}

h2 {
  counter-reset: sub-section
}

h3 { 
  counter-reset: composite
}

h2:before {
  counter-increment: section;
  content: counter(section) " ";
}

h3:before {
  counter-increment: sub-section;
  content: counter(section) "." counter(sub-section) " ";
}

/* toc counters */
.toc {
  counter-reset: toc-section
}

.toc > ul > li {
  counter-reset: toc-sub-section
}

.toc > ul > li:before {
  counter-increment: toc-section;
  content: counter(toc-section) " ";
}

.toc > ul > li > ul > li:before {
  counter-increment: toc-sub-section;
  content: counter(toc-section) "." counter(toc-sub-section) " ";
}



   </style>
 </head>
 <body>
<a style="float: left;" href="http://www.data-assimilation.net"><img src="http://www.data-assimilation.net/img/sangomalogo.jpg" alt="logo" height="80"></a>
   
   <h1>SANGOMA data assimilation tools (version 1.0)</h1>

<p style="clear: both">This software package from the <a href="http://www.data-assimilation.net">SANGOMA project</a> provides several utilities that are used in connection with data assimilation problems. Tools have been adapted to follow a <a href="http://data-assimilation.net/Documents/sangomaDL1.3.pdf">common data model</a>.</p>

<div class="toc">
<div id="toctitle">
Contents
</div>
<ul>
  <li><a href="#List_of_functions"><span>List of functions</span></a></li>
  <li><a href="#Requirements"><span>Requirements</span></a></li>
  <li><a href="#Installation_instructions"><span>Installation instructions</span></a>
  <ul>
  <li><a href="#Fortran"><span>Fortran tools</span></a>
  <li><a href="#octave"><span>MATLAB/GNU octave tools</span></a>
  </ul>
  </li>

  <li><a href="#Examples"><span>Examples</span></a></li>
  <li><a href="#Documentation"><span>Documentation</span></a></li>
  <li><a href="#License"><span>License</span></a></li>
  <li><a href="#Acknowledgment"><span>Acknowledgment</span></a></li>
</ul>
</div>


<h2><a id="List_of_functions">List of functions</a></h2>



<p>The software is organized in the following sub-directories:</p>

    <ul>
      <li><code>Fortran/</code> - Tools coded in Fortran
     <ul>
       <li><code>diagnostics/</code> functions to compute statistics to assess the performance of an assimilation system
       <ul> 
	 <li><code>sangoma_ComputeEnsStats.F90:</code> Compute ensemble rank histograms</li>
	 <li><code>sangoma_ComputeHistogram.F90:</code> Compute ensemble statistics</li>
<li><code>sangoma_ComputeMutInf.F90:</code> Compute mutual information</li>
<li><code>sangoma_ComputeRE.F90:</code> Compute relative entropy</li>
<li><code>sangoma_ComputeSensitivity.F90:</code> Compute ensemble sensitivity</li>
<li><code>sangoma_ComputeSensitivity_op.F90:</code> Compute ensemble sensitivity with observation operator given as a subroutine</li>
<li><code>sangoma_arm.F90:</code> Calculate array modes and associated quantities
<li><code>sangoma_computeBRIER.F90:</code> Compute the Brier skill score and its decompostion, and the entropy
<li><code>sangoma_computeCRPS.F90:</code> Compute the CRPS and its decomposition
<li><code>sangoma_computeRCRV.F90:</code> Compute the CRPS and its de-composition (Source File: sangoma_computeCRPS.F90) Compute the bias and the dispersion of the RCRV
       </ul></li>
       <li><code>perturbations:</code> methods to generate ensemble perturbations
	 <ul>
	   <li><code>sangoma_EOFCovar.F90:</code> Initialize covariance matrix from EOF decomposition</li>
	   <li><code>sangoma_MVNormalize.F90:</code> Perform multivariate normalization</li>
	   <li><code>mod_sangoma_pseudornd.F90:</code> Generate correlated random field
	 </ul>
       <li><code>transformations/</code>
	 <ul>
	 </ul>
       </li>
       <li><code>utilities/</code>
	 <ul>
	   <li><code>sangoma_computepod.F90:</code> Compute dominant POD modes from an ensemble of snapshots.</li>
	   <li><code>sangoma_costgrad.F90:</code>  Compute the values of Objective function and Gradient using reduced state dimensions.</li>
	 </ul>
       </li>
     </ul>
    </li>
    <li>
      <li><code>Matlab/</code> - Tools coded for Matlab and Octave
     <ul>
       <li><code>diagnostics/</code> functions to compute statistics to assess the performance of an assimilation system
       <ul> 
	 <li><code>mutual_information.m:</code> Compute mutual information in a particle filter</li>
	 <li><code>relative_entropy.m:</code> Compute relative entropy in a particle filter</li>
	 <li><code>sensitivity.m:</code> Compute sensitivity of posterior mean to observations in a particle filter</li>
       </ul></li>
       <li><code>perturbations:</code> various methods to generate ensemble perturbations
	 <ul>
	   <li><code>WCE:</code> Weakly constrained ensemble perturbations. Create ensemble perturbations that have to satisfy an a priori linear constraint</li>
	 </ul>
       <li><code>transformations:</code>
	 <ul>
	   <li><code>Anam:</code> Empirical Gaussian Anamorphosis. Determine the empirical transformation function such that a transformed variable follows a Gaussian distribution</li>
	 </ul>
       </li>
       <li><code>utilities:</code>
	 <ul>
	   <li><code>HFRadarExtract:</code> Observation operator for HF radar surface currents</li>
	 </ul>
       </li>
     </ul>
    </li>
    </ul>
   
   <h2><a id="Requirements">Requirements</a></h2>

   <ul>
     <li><b>GNU make</b> and a <b>Fortran compiler</b> (such as gfortran, ifort,...). Under Linux, make and gfortran can be installed by the package manager. For example under Debian/Ubuntu, gfortran and make are installed by:

       <pre class="code">
sudo apt-get install make gfortran libfftw3-dev</pre>
       
       For Red Hat/Fedora/Centos, these packages can be installed by:
       <pre class="code">
yum install make gcc-gfortran fftw-devel</pre>      

       For Windows and Mac OS, pre-compiled binaries of gfortran are available at <a href="http://gcc.gnu.org/wiki/GFortran">http://gcc.gnu.org/wiki/GFortran</a>.</li>
     <li><b>LAPACK</b> and <b>BLAS</b>. Reference versions of those libraries are available at <a href="http://www.netlib.org/lapack/">http://www.netlib.org/lapack/</a> and <a href="http://www.netlib.org/blas/">http://www.netlib.org/blas/</a>. An optimized version of BLAS should be preferred.</li>
     <li><b>FFTW</b> for computing the Fast Fourier Transform available at <a href="http://www.fftw.org/">http://www.fftw.org</a> for the tool <code>sangoma_pseudornd2D</code>.</li>
     <li><b>GNU octave</b> or <b>MATLAB</b>. GNU octave is an open-source clone of MATLAB available at <a href="http://www.gnu.org/software/octave/">http://www.gnu.org/software/octave/</a>.  </li>
     <li>Some tools use also the data assimilation framework <b>OpenDA</b> available at <a href="http://www.openda.org/">http://www.openda.org/</a>. OpenDA is based on <b>Java</b> (version 1.6 or higher) available at <a href="http://www.java.com">http://www.java.com</a>. Only the Java version from ORACLE is tested.</li>
   </ul>   


   <h2><a id="Installation_instructions">Installation instructions</a></h2>

   <p>Download the file <a href="http://sourceforge.net/projects/sangoma/files/sangoma-_VERSION_.tar.gz">http://sourceforge.net/projects/sangoma/files/sangoma-_VERSION_.tar.gz</a> from the Sourceforge site and decompress it. The decompressed files will be in a folder named <code>sangoma-_VERSION_</code></p>
     <pre class="code">
wget http://sourceforge.net/projects/sangoma/files/sangoma-_VERSION_.tar.gz
tar -xvzf sangoma-_VERSION_.tar.gz</pre>

   <h3><a id="Fortran">Fortran tools</a></h3>
   <p>The Fortran tools can be compiled by issuing <code>make</code> in subdirectory <code>Fortran/</code> of the <code>sangoma-_VERSION_</code> directory:</p>

     <pre class="code">
$ make
gfortran -O3 -fdefault-real-8  -I/usr/include  -c sangoma_base.F90 -o sangoma_base.o
...
gfortran -O3 -fdefault-real-8  -I/usr/include  -c perturbations/mod_sangoma_pseudornd.F90 -o perturbations/mod_sangoma_pseudornd.o
ar -r  libsangoma_tools.a  diagnostics/sangoma_ComputeEnsStats.o diagnostics/sangoma_ComputeHistogram.o diagnostics/sangoma_ComputeMutInf.o diagnostics/sangoma_ComputeSensitivity.o diagnostics/sangoma_ComputeSensitivity_op.o diagnostics/sangoma_ComputeRE.o diagnostics/sangoma_computeCRPS.o diagnostics/sangoma_computeRCRV.o diagnostics/sangoma_computeBRIER.o diagnostics/sangoma_arm.o perturbations/sangoma_EOFCovar.o perturbations/sangoma_MVNormalize.o perturbations/mod_sangoma_pseudornd.o
ar: creating libsangoma_tools.a
ranlib  libsangoma_tools.a
</pre>
     
<p>This creates a library called <code>libsangoma_tools.a</code> and the module files <code>mod_sangoma_pseudornd.mod</code> and <code>sangoma_base.mod</code> (possibly in uppercase depending on the compiler). The sangoma tools can be used from a Fortran or C program. A Fortran program must be compiled by using the option <code>-I</code> (indicating the path to the module files) and the option <code>-L</code> (the path of the library) and the name of the library <code>-lsangoma_tools</code>. For example:</p>

<pre class="code">
gfortran -I$HOME/src/sangoma/tools/trunk myprogram.f90 -L$HOME/src/sangoma/tools/trunk -lsangoma_tools
</pre>

<p>For a C program, only the options <code>-L$HOME/src/sangoma/tools/trunk</code> and <code>-lsangoma_tools</code> must be specified.</p>

<p>If a different Fortran compiler is used instead of gfortran, then the variables <code>FC</code> and <code>FFLAGS</code> in the Makefile need to be adapted.</p>

   <h3><a id="octave">MATLAB/GNU octave tools</a></h3>

<p>The MATLAB/GNU octave tools in the sub-directories of the directory <code>Matlab/</code> can be used by including the corresponding directory in your MATLAB/GNU octave search path by using the script <code>sangoma_addpath</code> for including all tools. Individual tools can be added by using:</p>

   <pre class="code">
addpath('/path/to/subfolder');</pre>

   <p>The tools <code>WCE</code>, <code>Anam</code> and <code>HFRadarExtract</code> include test scripts named <code>wce_demo</code>, <code>anam_test</code> and <code>test_hfradar_extractf</code> respectively that verifies the correct functioning of the packages.</p>


   <h2><a id="Examples">Examples</a></h2>

   <p>Examples for the tools are provided in the subdirectory <code>examples/</code> that is include in each category-directory. In case of theh Fortran codes, there is a Makefile in the directory that compiles all examples.</p>
      
   <h2><a id="Documentation">Documentation</a></h2>

   <p>Documentation of the tools is available at <a href="http://www.data-assimilation.net/Documents/sangomaDL2.4.pdf">http://www.data-assimilation.net/Documents/sangomaDL2.4.pdf</a>.</p>

   <h2><a id="License">License</a></h2>
   <p>This software release includes code distributed under the terms of the <a href="http://www.gnu.org/licenses/lgpl-3.0">GNU Lesser General Public License</a> (version 3 or later) and the <a href="http://www.gnu.org/licenses/gpl-2.0">GNU General Public License</a> (version 2 or later). The source code file contains a reference to the applicable license and the copyright holder.</p>

   <h2><a id="Acknowledgment">Acknowledgment</a></h2>
   SANGOMA is an European FP7-SPACE-2011 project, Grant 283580.
 </body>
</html>

<!--  LocalWords:  SANGOMA sangoma ComputeEnsStats ComputeHistogram
 -->
<!--  LocalWords:  EOFCovar MVNormalize WCE Anam Anamorphosis sudo ar
 -->
<!--  LocalWords:  HFRadarExtract gfortran gcc OpenDA wget xvzf FC px
 -->
<!--  LocalWords:  fdefault libsangoma ranlib lsangoma FFLAGS wce fff
 -->
<!--  LocalWords:  Makefile anam hfradar extractf verdana pre FP RCRV
 -->
<!--  LocalWords:  monospace CRPS EOF priori Fortran ifort libfftw ul
 -->
<!--  LocalWords:  dev fftw devel LAPACK BLAS MATLAB Sourceforge toc
 -->
<!--  LocalWords:  myprogram addpath FCF toctitle li
 -->
